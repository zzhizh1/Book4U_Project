{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  return t;\n};\n\nimport * as React from 'react';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\nimport IdentificationContext from '../contexts/IdentificationContext';\nimport Consumer from '../components/Consumer';\nimport { LIFECYCLE } from '../components/Provider';\nimport md5 from './md5';\nimport { warn } from './debug';\nimport getKeyByFiberNode from './getKeyByFiberNode';\nimport withIdentificationContextConsumer from './withIdentificationContextConsumer';\nimport withKeepAliveContextConsumer from './withKeepAliveContextConsumer';\nimport shallowEqual from './shallowEqual';\nimport getKeepAlive from './getKeepAlive';\nexport var COMMAND;\n\n(function (COMMAND) {\n  COMMAND[\"UNACTIVATE\"] = \"unactivate\";\n  COMMAND[\"UNMOUNT\"] = \"unmount\";\n  COMMAND[\"ACTIVATE\"] = \"activate\";\n  COMMAND[\"CURRENT_UNMOUNT\"] = \"current_unmount\";\n  COMMAND[\"CURRENT_UNACTIVATE\"] = \"current_unactivate\";\n})(COMMAND || (COMMAND = {}));\n/**\r\n * Decorating the <KeepAlive> component, the main function is to listen to events emitted by the upper <KeepAlive> component, triggering events of the current <KeepAlive> component.\r\n *\r\n * @export\r\n * @template P\r\n * @param {React.ComponentType<any>} Component\r\n * @returns {React.ComponentType<P>}\r\n */\n\n\nexport default function keepAliveDecorator(Component) {\n  var TriggerLifecycleContainer =\n  /** @class */\n  function (_super) {\n    __extends(TriggerLifecycleContainer, _super);\n\n    function TriggerLifecycleContainer(props) {\n      var args = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n\n      var _this = _super.apply(this, [props].concat(args)) || this;\n\n      _this.activated = false;\n      _this.ifStillActivate = false; // Let the lifecycle of the cached component be called normally.\n\n      _this.needActivate = true;\n      _this.lifecycle = LIFECYCLE.MOUNTED;\n\n      _this.activate = function () {\n        _this.activated = true;\n      };\n\n      _this.reactivate = function () {\n        _this.ifStillActivate = false;\n\n        _this.forceUpdate();\n      };\n\n      _this.isNeedActivate = function () {\n        return _this.needActivate;\n      };\n\n      _this.notNeedActivate = function () {\n        _this.needActivate = false;\n      };\n\n      _this.getLifecycle = function () {\n        return _this.lifecycle;\n      };\n\n      _this.setLifecycle = function (lifecycle) {\n        _this.lifecycle = lifecycle;\n      };\n\n      var cache = props._keepAliveContextProps.cache;\n\n      if (!cache) {\n        warn('[React Keep Alive] You should not use <KeepAlive> outside a <Provider>.');\n      }\n\n      return _this;\n    }\n\n    TriggerLifecycleContainer.prototype.componentDidMount = function () {\n      if (!this.ifStillActivate) {\n        this.activate();\n      }\n\n      var _a = this.props,\n          keepAlive = _a.keepAlive,\n          eventEmitter = _a._keepAliveContextProps.eventEmitter;\n\n      if (keepAlive) {\n        this.needActivate = true;\n        eventEmitter.emit([this.identification, COMMAND.ACTIVATE]);\n      }\n    };\n\n    TriggerLifecycleContainer.prototype.componentDidCatch = function () {\n      if (!this.activated) {\n        this.activate();\n      }\n    };\n\n    TriggerLifecycleContainer.prototype.componentWillUnmount = function () {\n      var _a = this.props,\n          getCombinedKeepAlive = _a.getCombinedKeepAlive,\n          _b = _a._keepAliveContextProps,\n          eventEmitter = _b.eventEmitter,\n          isExisted = _b.isExisted;\n      var keepAlive = getCombinedKeepAlive();\n\n      if (!keepAlive || !isExisted()) {\n        eventEmitter.emit([this.identification, COMMAND.CURRENT_UNMOUNT]);\n        eventEmitter.emit([this.identification, COMMAND.UNMOUNT]);\n      } // When the Provider components are unmounted, the cache is not needed,\n      // so you don't have to execute the componentWillUnactivate lifecycle.\n\n\n      if (keepAlive && isExisted()) {\n        eventEmitter.emit([this.identification, COMMAND.CURRENT_UNACTIVATE]);\n        eventEmitter.emit([this.identification, COMMAND.UNACTIVATE]);\n      }\n    };\n\n    TriggerLifecycleContainer.prototype.render = function () {\n      var _a = this.props,\n          propKey = _a.propKey,\n          keepAlive = _a.keepAlive,\n          extra = _a.extra,\n          getCombinedKeepAlive = _a.getCombinedKeepAlive,\n          _b = _a._keepAliveContextProps,\n          isExisted = _b.isExisted,\n          storeElement = _b.storeElement,\n          cache = _b.cache,\n          eventEmitter = _b.eventEmitter,\n          setCache = _b.setCache,\n          unactivate = _b.unactivate,\n          providerIdentification = _b.providerIdentification,\n          wrapperProps = __rest(_a, [\"propKey\", \"keepAlive\", \"extra\", \"getCombinedKeepAlive\", \"_keepAliveContextProps\"]);\n\n      if (!this.identification) {\n        // We need to generate a corresponding unique identifier based on the information of the component.\n        this.identification = md5(\"\" + providerIdentification + propKey); // The last activated component must be unactivated before it can be activated again.\n\n        var currentCache = cache[this.identification];\n\n        if (currentCache) {\n          this.ifStillActivate = currentCache.activated;\n          currentCache.ifStillActivate = this.ifStillActivate;\n          currentCache.reactivate = this.reactivate;\n        }\n      }\n\n      var _c = this,\n          isNeedActivate = _c.isNeedActivate,\n          notNeedActivate = _c.notNeedActivate,\n          activated = _c.activated,\n          getLifecycle = _c.getLifecycle,\n          setLifecycle = _c.setLifecycle,\n          identification = _c.identification,\n          ifStillActivate = _c.ifStillActivate;\n\n      return !ifStillActivate ? React.createElement(Consumer, {\n        identification: identification,\n        keepAlive: keepAlive,\n        cache: cache,\n        setCache: setCache,\n        unactivate: unactivate\n      }, React.createElement(IdentificationContext.Provider, {\n        value: {\n          identification: identification,\n          eventEmitter: eventEmitter,\n          keepAlive: keepAlive,\n          activated: activated,\n          getLifecycle: getLifecycle,\n          isExisted: isExisted,\n          extra: extra\n        }\n      }, React.createElement(Component, __assign({}, wrapperProps, {\n        _container: {\n          isNeedActivate: isNeedActivate,\n          notNeedActivate: notNeedActivate,\n          setLifecycle: setLifecycle,\n          eventEmitter: eventEmitter,\n          identification: identification,\n          storeElement: storeElement,\n          keepAlive: keepAlive,\n          cache: cache\n        }\n      })))) : null;\n    };\n\n    return TriggerLifecycleContainer;\n  }(React.PureComponent);\n\n  var ListenUpperKeepAliveContainer =\n  /** @class */\n  function (_super) {\n    __extends(ListenUpperKeepAliveContainer, _super);\n\n    function ListenUpperKeepAliveContainer() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.state = {\n        activated: true\n      };\n\n      _this.getCombinedKeepAlive = function () {\n        return _this.combinedKeepAlive;\n      };\n\n      return _this;\n    }\n\n    ListenUpperKeepAliveContainer.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n      if (this.state.activated !== nextState.activated) {\n        return true;\n      }\n\n      var _a = this.props,\n          _keepAliveContextProps = _a._keepAliveContextProps,\n          _identificationContextProps = _a._identificationContextProps,\n          rest = __rest(_a, [\"_keepAliveContextProps\", \"_identificationContextProps\"]);\n\n      var nextKeepAliveContextProps = nextProps._keepAliveContextProps,\n          nextIdentificationContextProps = nextProps._identificationContextProps,\n          nextRest = __rest(nextProps, [\"_keepAliveContextProps\", \"_identificationContextProps\"]);\n\n      if (!shallowEqual(rest, nextRest)) {\n        return true;\n      }\n\n      if (!shallowEqual(_keepAliveContextProps, nextKeepAliveContextProps) || !shallowEqual(_identificationContextProps, nextIdentificationContextProps)) {\n        return true;\n      }\n\n      return false;\n    };\n\n    ListenUpperKeepAliveContainer.prototype.componentDidMount = function () {\n      this.listenUpperKeepAlive();\n    };\n\n    ListenUpperKeepAliveContainer.prototype.componentWillUnmount = function () {\n      this.unlistenUpperKeepAlive();\n    };\n\n    ListenUpperKeepAliveContainer.prototype.listenUpperKeepAlive = function () {\n      var _this = this;\n\n      var _a = this.props._identificationContextProps,\n          identification = _a.identification,\n          eventEmitter = _a.eventEmitter;\n\n      if (!identification) {\n        return;\n      }\n\n      eventEmitter.on([identification, COMMAND.ACTIVATE], this.activate = function () {\n        return _this.setState({\n          activated: true\n        });\n      }, true);\n      eventEmitter.on([identification, COMMAND.UNACTIVATE], this.unactivate = function () {\n        return _this.setState({\n          activated: false\n        });\n      }, true);\n      eventEmitter.on([identification, COMMAND.UNMOUNT], this.unmount = function () {\n        return _this.setState({\n          activated: false\n        });\n      }, true);\n    };\n\n    ListenUpperKeepAliveContainer.prototype.unlistenUpperKeepAlive = function () {\n      var _a = this.props._identificationContextProps,\n          identification = _a.identification,\n          eventEmitter = _a.eventEmitter;\n\n      if (!identification) {\n        return;\n      }\n\n      eventEmitter.off([identification, COMMAND.ACTIVATE], this.activate);\n      eventEmitter.off([identification, COMMAND.UNACTIVATE], this.unactivate);\n      eventEmitter.off([identification, COMMAND.UNMOUNT], this.unmount);\n    };\n\n    ListenUpperKeepAliveContainer.prototype.render = function () {\n      var _a = this.props,\n          _b = _a._identificationContextProps,\n          identification = _b.identification,\n          upperKeepAlive = _b.keepAlive,\n          getLifecycle = _b.getLifecycle,\n          disabled = _a.disabled,\n          name = _a.name,\n          wrapperProps = __rest(_a, [\"_identificationContextProps\", \"disabled\", \"name\"]);\n\n      var activated = this.state.activated;\n      var _c = wrapperProps._keepAliveContextProps,\n          include = _c.include,\n          exclude = _c.exclude; // When the parent KeepAlive component is mounted or unmounted,\n      // use the keepAlive prop of the parent KeepAlive component.\n\n      var propKey = name || getKeyByFiberNode(this._reactInternalFiber);\n\n      if (!propKey) {\n        warn('[React Keep Alive] <KeepAlive> components must have key or name.');\n        return null;\n      }\n\n      var newKeepAlive = getKeepAlive(propKey, include, exclude, disabled);\n      this.combinedKeepAlive = getLifecycle === undefined || getLifecycle() === LIFECYCLE.UPDATING ? newKeepAlive : identification ? upperKeepAlive && newKeepAlive : newKeepAlive;\n      return activated ? React.createElement(TriggerLifecycleContainer, __assign({}, wrapperProps, {\n        key: propKey,\n        propKey: propKey,\n        keepAlive: this.combinedKeepAlive,\n        getCombinedKeepAlive: this.getCombinedKeepAlive\n      })) : null;\n    };\n\n    return ListenUpperKeepAliveContainer;\n  }(React.Component);\n\n  var KeepAlive = withKeepAliveContextConsumer(withIdentificationContextConsumer(ListenUpperKeepAliveContainer));\n  return hoistNonReactStatics(KeepAlive, Component);\n}","map":{"version":3,"sources":["/Users/miabb/node_modules/react-component-keepalive/es/utils/keepAliveDecorator.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","React","hoistNonReactStatics","IdentificationContext","Consumer","LIFECYCLE","md5","warn","getKeyByFiberNode","withIdentificationContextConsumer","withKeepAliveContextConsumer","shallowEqual","getKeepAlive","COMMAND","keepAliveDecorator","Component","TriggerLifecycleContainer","_super","props","args","_i","_this","concat","activated","ifStillActivate","needActivate","lifecycle","MOUNTED","activate","reactivate","forceUpdate","isNeedActivate","notNeedActivate","getLifecycle","setLifecycle","cache","_keepAliveContextProps","componentDidMount","_a","keepAlive","eventEmitter","emit","identification","ACTIVATE","componentDidCatch","componentWillUnmount","getCombinedKeepAlive","_b","isExisted","CURRENT_UNMOUNT","UNMOUNT","CURRENT_UNACTIVATE","UNACTIVATE","render","propKey","extra","storeElement","setCache","unactivate","providerIdentification","wrapperProps","currentCache","_c","createElement","Provider","value","_container","PureComponent","ListenUpperKeepAliveContainer","state","combinedKeepAlive","shouldComponentUpdate","nextProps","nextState","_identificationContextProps","rest","nextKeepAliveContextProps","nextIdentificationContextProps","nextRest","listenUpperKeepAlive","unlistenUpperKeepAlive","on","setState","unmount","off","upperKeepAlive","disabled","name","include","exclude","_reactInternalFiber","newKeepAlive","undefined","UPDATING","key","KeepAlive"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n};\r\nimport * as React from 'react';\r\nimport hoistNonReactStatics from 'hoist-non-react-statics';\r\nimport IdentificationContext from '../contexts/IdentificationContext';\r\nimport Consumer from '../components/Consumer';\r\nimport { LIFECYCLE } from '../components/Provider';\r\nimport md5 from './md5';\r\nimport { warn } from './debug';\r\nimport getKeyByFiberNode from './getKeyByFiberNode';\r\nimport withIdentificationContextConsumer from './withIdentificationContextConsumer';\r\nimport withKeepAliveContextConsumer from './withKeepAliveContextConsumer';\r\nimport shallowEqual from './shallowEqual';\r\nimport getKeepAlive from './getKeepAlive';\r\nexport var COMMAND;\r\n(function (COMMAND) {\r\n    COMMAND[\"UNACTIVATE\"] = \"unactivate\";\r\n    COMMAND[\"UNMOUNT\"] = \"unmount\";\r\n    COMMAND[\"ACTIVATE\"] = \"activate\";\r\n    COMMAND[\"CURRENT_UNMOUNT\"] = \"current_unmount\";\r\n    COMMAND[\"CURRENT_UNACTIVATE\"] = \"current_unactivate\";\r\n})(COMMAND || (COMMAND = {}));\r\n/**\r\n * Decorating the <KeepAlive> component, the main function is to listen to events emitted by the upper <KeepAlive> component, triggering events of the current <KeepAlive> component.\r\n *\r\n * @export\r\n * @template P\r\n * @param {React.ComponentType<any>} Component\r\n * @returns {React.ComponentType<P>}\r\n */\r\nexport default function keepAliveDecorator(Component) {\r\n    var TriggerLifecycleContainer = /** @class */ (function (_super) {\r\n        __extends(TriggerLifecycleContainer, _super);\r\n        function TriggerLifecycleContainer(props) {\r\n            var args = [];\r\n            for (var _i = 1; _i < arguments.length; _i++) {\r\n                args[_i - 1] = arguments[_i];\r\n            }\r\n            var _this = _super.apply(this, [props].concat(args)) || this;\r\n            _this.activated = false;\r\n            _this.ifStillActivate = false;\r\n            // Let the lifecycle of the cached component be called normally.\r\n            _this.needActivate = true;\r\n            _this.lifecycle = LIFECYCLE.MOUNTED;\r\n            _this.activate = function () {\r\n                _this.activated = true;\r\n            };\r\n            _this.reactivate = function () {\r\n                _this.ifStillActivate = false;\r\n                _this.forceUpdate();\r\n            };\r\n            _this.isNeedActivate = function () {\r\n                return _this.needActivate;\r\n            };\r\n            _this.notNeedActivate = function () {\r\n                _this.needActivate = false;\r\n            };\r\n            _this.getLifecycle = function () {\r\n                return _this.lifecycle;\r\n            };\r\n            _this.setLifecycle = function (lifecycle) {\r\n                _this.lifecycle = lifecycle;\r\n            };\r\n            var cache = props._keepAliveContextProps.cache;\r\n            if (!cache) {\r\n                warn('[React Keep Alive] You should not use <KeepAlive> outside a <Provider>.');\r\n            }\r\n            return _this;\r\n        }\r\n        TriggerLifecycleContainer.prototype.componentDidMount = function () {\r\n            if (!this.ifStillActivate) {\r\n                this.activate();\r\n            }\r\n            var _a = this.props, keepAlive = _a.keepAlive, eventEmitter = _a._keepAliveContextProps.eventEmitter;\r\n            if (keepAlive) {\r\n                this.needActivate = true;\r\n                eventEmitter.emit([this.identification, COMMAND.ACTIVATE]);\r\n            }\r\n        };\r\n        TriggerLifecycleContainer.prototype.componentDidCatch = function () {\r\n            if (!this.activated) {\r\n                this.activate();\r\n            }\r\n        };\r\n        TriggerLifecycleContainer.prototype.componentWillUnmount = function () {\r\n            var _a = this.props, getCombinedKeepAlive = _a.getCombinedKeepAlive, _b = _a._keepAliveContextProps, eventEmitter = _b.eventEmitter, isExisted = _b.isExisted;\r\n            var keepAlive = getCombinedKeepAlive();\r\n            if (!keepAlive || !isExisted()) {\r\n                eventEmitter.emit([this.identification, COMMAND.CURRENT_UNMOUNT]);\r\n                eventEmitter.emit([this.identification, COMMAND.UNMOUNT]);\r\n            }\r\n            // When the Provider components are unmounted, the cache is not needed,\r\n            // so you don't have to execute the componentWillUnactivate lifecycle.\r\n            if (keepAlive && isExisted()) {\r\n                eventEmitter.emit([this.identification, COMMAND.CURRENT_UNACTIVATE]);\r\n                eventEmitter.emit([this.identification, COMMAND.UNACTIVATE]);\r\n            }\r\n        };\r\n        TriggerLifecycleContainer.prototype.render = function () {\r\n            var _a = this.props, propKey = _a.propKey, keepAlive = _a.keepAlive, extra = _a.extra, getCombinedKeepAlive = _a.getCombinedKeepAlive, _b = _a._keepAliveContextProps, isExisted = _b.isExisted, storeElement = _b.storeElement, cache = _b.cache, eventEmitter = _b.eventEmitter, setCache = _b.setCache, unactivate = _b.unactivate, providerIdentification = _b.providerIdentification, wrapperProps = __rest(_a, [\"propKey\", \"keepAlive\", \"extra\", \"getCombinedKeepAlive\", \"_keepAliveContextProps\"]);\r\n            if (!this.identification) {\r\n                // We need to generate a corresponding unique identifier based on the information of the component.\r\n                this.identification = md5(\"\" + providerIdentification + propKey);\r\n                // The last activated component must be unactivated before it can be activated again.\r\n                var currentCache = cache[this.identification];\r\n                if (currentCache) {\r\n                    this.ifStillActivate = currentCache.activated;\r\n                    currentCache.ifStillActivate = this.ifStillActivate;\r\n                    currentCache.reactivate = this.reactivate;\r\n                }\r\n            }\r\n            var _c = this, isNeedActivate = _c.isNeedActivate, notNeedActivate = _c.notNeedActivate, activated = _c.activated, getLifecycle = _c.getLifecycle, setLifecycle = _c.setLifecycle, identification = _c.identification, ifStillActivate = _c.ifStillActivate;\r\n            return !ifStillActivate\r\n                ? (React.createElement(Consumer, { identification: identification, keepAlive: keepAlive, cache: cache, setCache: setCache, unactivate: unactivate },\r\n                    React.createElement(IdentificationContext.Provider, { value: {\r\n                            identification: identification,\r\n                            eventEmitter: eventEmitter,\r\n                            keepAlive: keepAlive,\r\n                            activated: activated,\r\n                            getLifecycle: getLifecycle,\r\n                            isExisted: isExisted,\r\n                            extra: extra,\r\n                        } },\r\n                        React.createElement(Component, __assign({}, wrapperProps, { _container: {\r\n                                isNeedActivate: isNeedActivate,\r\n                                notNeedActivate: notNeedActivate,\r\n                                setLifecycle: setLifecycle,\r\n                                eventEmitter: eventEmitter,\r\n                                identification: identification,\r\n                                storeElement: storeElement,\r\n                                keepAlive: keepAlive,\r\n                                cache: cache,\r\n                            } })))))\r\n                : null;\r\n        };\r\n        return TriggerLifecycleContainer;\r\n    }(React.PureComponent));\r\n    var ListenUpperKeepAliveContainer = /** @class */ (function (_super) {\r\n        __extends(ListenUpperKeepAliveContainer, _super);\r\n        function ListenUpperKeepAliveContainer() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.state = {\r\n                activated: true,\r\n            };\r\n            _this.getCombinedKeepAlive = function () {\r\n                return _this.combinedKeepAlive;\r\n            };\r\n            return _this;\r\n        }\r\n        ListenUpperKeepAliveContainer.prototype.shouldComponentUpdate = function (nextProps, nextState) {\r\n            if (this.state.activated !== nextState.activated) {\r\n                return true;\r\n            }\r\n            var _a = this.props, _keepAliveContextProps = _a._keepAliveContextProps, _identificationContextProps = _a._identificationContextProps, rest = __rest(_a, [\"_keepAliveContextProps\", \"_identificationContextProps\"]);\r\n            var nextKeepAliveContextProps = nextProps._keepAliveContextProps, nextIdentificationContextProps = nextProps._identificationContextProps, nextRest = __rest(nextProps, [\"_keepAliveContextProps\", \"_identificationContextProps\"]);\r\n            if (!shallowEqual(rest, nextRest)) {\r\n                return true;\r\n            }\r\n            if (!shallowEqual(_keepAliveContextProps, nextKeepAliveContextProps) ||\r\n                !shallowEqual(_identificationContextProps, nextIdentificationContextProps)) {\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        ListenUpperKeepAliveContainer.prototype.componentDidMount = function () {\r\n            this.listenUpperKeepAlive();\r\n        };\r\n        ListenUpperKeepAliveContainer.prototype.componentWillUnmount = function () {\r\n            this.unlistenUpperKeepAlive();\r\n        };\r\n        ListenUpperKeepAliveContainer.prototype.listenUpperKeepAlive = function () {\r\n            var _this = this;\r\n            var _a = this.props._identificationContextProps, identification = _a.identification, eventEmitter = _a.eventEmitter;\r\n            if (!identification) {\r\n                return;\r\n            }\r\n            eventEmitter.on([identification, COMMAND.ACTIVATE], this.activate = function () { return _this.setState({ activated: true }); }, true);\r\n            eventEmitter.on([identification, COMMAND.UNACTIVATE], this.unactivate = function () { return _this.setState({ activated: false }); }, true);\r\n            eventEmitter.on([identification, COMMAND.UNMOUNT], this.unmount = function () { return _this.setState({ activated: false }); }, true);\r\n        };\r\n        ListenUpperKeepAliveContainer.prototype.unlistenUpperKeepAlive = function () {\r\n            var _a = this.props._identificationContextProps, identification = _a.identification, eventEmitter = _a.eventEmitter;\r\n            if (!identification) {\r\n                return;\r\n            }\r\n            eventEmitter.off([identification, COMMAND.ACTIVATE], this.activate);\r\n            eventEmitter.off([identification, COMMAND.UNACTIVATE], this.unactivate);\r\n            eventEmitter.off([identification, COMMAND.UNMOUNT], this.unmount);\r\n        };\r\n        ListenUpperKeepAliveContainer.prototype.render = function () {\r\n            var _a = this.props, _b = _a._identificationContextProps, identification = _b.identification, upperKeepAlive = _b.keepAlive, getLifecycle = _b.getLifecycle, disabled = _a.disabled, name = _a.name, wrapperProps = __rest(_a, [\"_identificationContextProps\", \"disabled\", \"name\"]);\r\n            var activated = this.state.activated;\r\n            var _c = wrapperProps._keepAliveContextProps, include = _c.include, exclude = _c.exclude;\r\n            // When the parent KeepAlive component is mounted or unmounted,\r\n            // use the keepAlive prop of the parent KeepAlive component.\r\n            var propKey = name || getKeyByFiberNode(this._reactInternalFiber);\r\n            if (!propKey) {\r\n                warn('[React Keep Alive] <KeepAlive> components must have key or name.');\r\n                return null;\r\n            }\r\n            var newKeepAlive = getKeepAlive(propKey, include, exclude, disabled);\r\n            this.combinedKeepAlive = getLifecycle === undefined || getLifecycle() === LIFECYCLE.UPDATING\r\n                ? newKeepAlive\r\n                : identification\r\n                    ? upperKeepAlive && newKeepAlive\r\n                    : newKeepAlive;\r\n            return activated\r\n                ? (React.createElement(TriggerLifecycleContainer, __assign({}, wrapperProps, { key: propKey, propKey: propKey, keepAlive: this.combinedKeepAlive, getCombinedKeepAlive: this.getCombinedKeepAlive })))\r\n                : null;\r\n        };\r\n        return ListenUpperKeepAliveContainer;\r\n    }(React.Component));\r\n    var KeepAlive = withKeepAliveContextConsumer(withIdentificationContextConsumer(ListenUpperKeepAliveContainer));\r\n    return hoistNonReactStatics(KeepAlive, Component);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}