{"ast":null,"code":"var _jsxFileName = \"/Users/miabb/Desktop/Project550/client/src/components/Login.js\";\nimport PageNavbar from './PageNavbar';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport '../style/Login.css';\nimport Logo from \"../assets/images/book.png\";\nimport { GoogleLogin, GoogleLogout } from 'react-google-login';\nconst CLIENT_ID = \"909866232229-5jrtcuonesmii7v05fpe4fbvtqrjpr1f.apps.googleusercontent.com\";\n\nclass Login extends React.Component {\n  constructor(props) {\n    let storage = window.localStorage;\n    storage.setItem(\"username\", \"\");\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      loggedIn: \"FALSE\",\n      isLoggedIn: false,\n      accessToken: ''\n    };\n    this.login = this.login.bind(this);\n    this.handleLoginFailure = this.handleLoginFailure.bind(this);\n    this.logout = this.logout.bind(this);\n    this.handleLogoutFailure = this.handleLogoutFailure.bind(this);\n    this.owners = [{\n      name: \"demo\",\n      pwd: \"123456\"\n    }, {\n      name: \"oliver\",\n      pwd: \"123456\"\n    }];\n    const eventsArr = [//按钮点击事件\n    \"onLogin\", //user name输入改变\n    \"onChangeName\", //password输入改变\n    \"onChangePwd\", \"onSignUp\", \"onLogout\"];\n    eventsArr.map(ev => {\n      this[ev] = this[ev].bind(this);\n      return \"\";\n    });\n  }\n\n  onChangeName(e) {\n    this.setState({\n      username: e.target.value\n    });\n    this.setState({\n      errorMsg: ''\n    });\n  }\n\n  onChangePwd(e) {\n    this.setState({\n      password: e.target.value\n    });\n  }\n\n  onLogin(event) {\n    window.localStorage.clear();\n    let storage = window.localStorage;\n    event.preventDefault();\n    fetch(\"http://localhost:8081/login?username=\" + this.state.username + \"&password=\" + this.state.password, {\n      method: 'GET'\n    }) // The type of HTTP request.\n    .then(res => res.json()) // Convert the response data to a JSON.\n    .then(res => {\n      if (res.length > 0) {\n        storage.setItem(\"username\", this.state.username);\n        this.setState({\n          loggedIn: \"TRUE\"\n        });\n        alert(\"Valid account\");\n      } else {\n        alert(\"Invalid account\");\n        this.setState({\n          username: \"\"\n        });\n        this.setState({\n          password: \"\"\n        });\n      }\n    }).catch(err => console.log(err)); // Print the error if there is one.\n  }\n\n  onLogout(event) {\n    event.preventDefault();\n    let storage = window.localStorage;\n    let username = storage.getItem(\"username\");\n\n    if (username != null & username != \"\") {\n      alert(\"Logout success\");\n      this.setState({\n        username: \"\"\n      });\n      this.setState({\n        password: \"\"\n      });\n      this.setState({\n        loggedIn: \"FALSE\"\n      });\n    } else {\n      alert(\"Please Log in\");\n    }\n\n    window.localStorage.clear();\n  }\n\n  onSignUp(event) {\n    event.preventDefault();\n    fetch(\"http://localhost:8081/signup?username=\" + this.state.username, {\n      method: 'GET'\n    }) // The type of HTTP request.\n    .then(res => res.json()) // Convert the response data to a JSON.\n    .then(res => {\n      if (res.length === 0) {\n        alert(\"Valid account\");\n        this.addAccount(event);\n      } else {\n        alert(\"Account existed\");\n        this.setState({\n          username: \"\"\n        });\n        this.setState({\n          password: \"\"\n        });\n      }\n    }).catch(err => console.log(err)); // Print the error if there is one.\n  }\n\n  addAccount(event) {\n    fetch(\"http://localhost:8081/addAccount?username=\" + this.state.username + \"&password=\" + this.state.password, {\n      method: 'POST',\n      data: {\n        username: this.state.username,\n        password: this.state.password\n      }\n    }) // The type of HTTP request.\n    .then(res => res.json()) // Convert the response data to a JSON.\n    .catch(err => console.log(err)); // Print the error if there is one.\n  }\n\n  login(response) {\n    if (response.accessToken) {\n      this.setState(state => ({\n        isLoggedIn: true,\n        accessToken: response.accessToken\n      }));\n    }\n  }\n\n  logout(response) {\n    this.setState(state => ({\n      isLoggedIn: false,\n      accessToken: ''\n    }));\n  }\n\n  handleLoginFailure(response) {\n    alert('Log in Failure');\n  }\n\n  handleLogoutFailure(response) {\n    alert('Log out Failure');\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(PageNavbar, {\n      active: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 4\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 4\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"img\",\n      id: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: Logo,\n      className: \"logo-img\",\n      id: \"img\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 11\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"small-middle-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 4\n      }\n    }, this.state.loggedIn === \"TRUE\" ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"info-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"info\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 17\n      }\n    }, \"Welcome, \", this.state.username), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btn-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-light\",\n      onClick: this.onLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 3\n      }\n    }, \"Logout\")), \" \") : /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.submitForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"Username\",\n      value: this.state.username,\n      type: \"text\",\n      onChange: this.onChangeName,\n      className: \"form-control\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 4\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"Password\",\n      value: this.state.password,\n      type: \"password\",\n      className: \"form-control\",\n      id: \"exampleInputPassword1\",\n      onChange: this.onChangePwd,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 4\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btn-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-light\",\n      onClick: this.onLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 4\n      }\n    }, \"  Login   \"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-light\",\n      onClick: this.onSignUp,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 4\n      }\n    }, \"Sign Up\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 1\n      }\n    }, this.state.isLoggedIn ? /*#__PURE__*/React.createElement(GoogleLogout, {\n      clientId: CLIENT_ID,\n      buttonText: \"Logout\",\n      onLogoutSuccess: this.logout,\n      OnFailure: this.handleLogoutFailure,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }\n    }) : /*#__PURE__*/React.createElement(GoogleLogin, {\n      clientId: CLIENT_ID,\n      buttonText: \"Google Login\",\n      onSuccess: this.login,\n      OnFailure: this.handleLoginFailure,\n      responseType: \"code,token\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-small\",\n      id: \"logout\",\n      onClick: this.onLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 7\n      }\n    }, \"Logout\")), this.state.accessToken ? /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 33\n      }\n    }, \" You access token: \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 56\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 61\n      }\n    }), \" \", this.state.accessToken) : null)));\n  }\n\n}\n\nexport default withRouter(Login);","map":{"version":3,"sources":["/Users/miabb/Desktop/Project550/client/src/components/Login.js"],"names":["PageNavbar","React","withRouter","Logo","GoogleLogin","GoogleLogout","CLIENT_ID","Login","Component","constructor","props","storage","window","localStorage","setItem","state","username","password","loggedIn","isLoggedIn","accessToken","login","bind","handleLoginFailure","logout","handleLogoutFailure","owners","name","pwd","eventsArr","map","ev","onChangeName","e","setState","target","value","errorMsg","onChangePwd","onLogin","event","clear","preventDefault","fetch","method","then","res","json","length","alert","catch","err","console","log","onLogout","getItem","onSignUp","addAccount","data","response","render","submitForm"],"mappings":"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","sourcesContent":["import PageNavbar from './PageNavbar';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom'\nimport '../style/Login.css';\nimport Logo from \"../assets/images/book.png\";\nimport {GoogleLogin, GoogleLogout} from 'react-google-login';\n\nconst CLIENT_ID = \"909866232229-5jrtcuonesmii7v05fpe4fbvtqrjpr1f.apps.googleusercontent.com\";\nclass Login extends React.Component {\n  constructor(props) {\n    let storage = window.localStorage;\n    storage.setItem(\"username\", \"\");\n    super(props);\n    this.state = {\n      username: \"\",\n      password:\"\",\n      loggedIn:\"FALSE\",\n      isLoggedIn:false,\n      accessToken:''\n    };\n\n    this.login = this.login.bind(this);\n    this.handleLoginFailure = this.handleLoginFailure.bind(this);\n    this.logout = this.logout.bind(this);\n    this.handleLogoutFailure = this.handleLogoutFailure.bind(this);\n\n    this.owners = [\n    { name: \"demo\", pwd: \"123456\" },\n    { name: \"oliver\",pwd: \"123456\"}]\n    const eventsArr = [\n        //按钮点击事件\n        \"onLogin\",\n        //user name输入改变\n        \"onChangeName\",\n        //password输入改变\n        \"onChangePwd\",\n        \"onSignUp\",\n        \"onLogout\"\n        ];\n        eventsArr.map((ev) => {\n          this[ev] = this[ev].bind(this);\n          return \"\";\n        });\n\n      }\n\n      onChangeName(e) {\n          this.setState({ username: e.target.value });\n          this.setState({ errorMsg: '' });\n        \n      }\n\n      onChangePwd(e) {\n          this.setState({ password: e.target.value });\n      }\n\n      onLogin(event) {\n        window.localStorage.clear();\n        let storage = window.localStorage;\n\n        event.preventDefault();\n        fetch(\"http://localhost:8081/login?username=\"+this.state.username+\"&password=\"+this.state.password, {\n          method: 'GET'}) // The type of HTTP request.\n\n       .then(res => res.json()) // Convert the response data to a JSON.\n       .then(res => {\n\n        if (res.length > 0) {\n          storage.setItem(\"username\", this.state.username);\n          this.setState({ loggedIn:\"TRUE\"});\n          alert(\"Valid account\");\n        }\n        \n      else {\n        alert(\"Invalid account\");\n        this.setState({username:\"\"});\n        this.setState({password:\"\"});\n        }\n       })\n       .catch(err => console.log(err)); // Print the error if there is one.\n\n\n       }\n\n       onLogout(event){\n        event.preventDefault();\n        let storage = window.localStorage;\n        let username = storage.getItem(\"username\");\n        if(username != null & username != \"\"){\n          alert(\"Logout success\");\n\n          this.setState({username:\"\"});\n          this.setState({password:\"\"});\n          this.setState({loggedIn:\"FALSE\"});\n        }\n        else{\n          alert(\"Please Log in\");\n        }\n        window.localStorage.clear();\n\n      }\n\n\n\n     onSignUp(event){\n      event.preventDefault();\n      fetch(\"http://localhost:8081/signup?username=\"+this.state.username, {\n       method: 'GET'}) // The type of HTTP request.\n\n       .then(res => res.json()) // Convert the response data to a JSON.\n       .then(res => {\n        if (res.length === 0) {\n          alert(\"Valid account\");\n          this.addAccount(event);\n\n        }\n        \n      else {\n        alert(\"Account existed\");\n        this.setState({username:\"\"});\n        this.setState({password:\"\"});\n        }\n       })\n       .catch(err => console.log(err)); // Print the error if there is one.\n  } \n\n  addAccount(event){\n      fetch(\"http://localhost:8081/addAccount?username=\"+this.state.username+\"&password=\"+this.state.password, {\n       method: 'POST',\n       data: {\n          username: this.state.username,\n          password: this.state.password\n        }}) // The type of HTTP request.\n\n       .then(res => res.json()) // Convert the response data to a JSON.\n       .catch(err => console.log(err)); // Print the error if there is one.\n  }\n  login(response){\n\n      if(response.accessToken){\n\n        this.setState(state =>({\n          isLoggedIn:true,\n          accessToken:response.accessToken\n        }));\n      }\n    }\n    logout(response){\n\n        this.setState(state =>({\n          isLoggedIn:false,\n          accessToken:''\n        }));  \n    }\n\n    handleLoginFailure(response){\n      alert('Log in Failure');\n    }\n\n    handleLogoutFailure(response){\n      alert('Log out Failure');\n    }\n    \n\n\n  render() {\n  return (\n   <div className=\"Login\">\n\n   <PageNavbar active=\"login\" />\n\n   <br></br>\n   \n   <div className=\"search\">\n      <div className=\"img\" id=\"logo\">\n          <img src={Logo} className=\"logo-img\" id=\"img\"/>\n      </div>\n    </div>\n\n   <div className=\"small-middle-container\">\n{this.state.loggedIn ===\"TRUE\" ? (\n\n  \n<div className=\"info-container\">\n                <h5 className=\"info\">Welcome, {this.state.username}</h5>\n\n<div className=\"btn-group\">                \n\n  <button className=\"btn btn-light\" onClick={this.onLogout}>Logout</button> \n\n </div> </div>\n\n\n  \n):(\n<form onSubmit={this.submitForm} >\n   <div className=\"form-group\">\n   <input placeholder=\"Username\" value= {this.state.username} type= \"text\" onChange={this.onChangeName} className=\"form-control\"/>\n   </div>\n\n   <div className=\"form-group\">\n   <input placeholder=\"Password\" value={this.state.password} type=\"password\" className=\"form-control\" id=\"exampleInputPassword1\" \n   onChange={this.onChangePwd}/>\n   </div>\n\n<div className=\"btn-group\">                \n   <button className=\"btn btn-light\" onClick={this.onLogin}>  Login   </button>\n   <button className=\"btn btn-light\" onClick={this.onSignUp}>Sign Up</button> \n\n </div>\n\n<div id=\"login\">\n      {\n        this.state.isLoggedIn ?\n        <GoogleLogout\n        clientId = {CLIENT_ID}\n        buttonText = 'Logout'\n        onLogoutSuccess={this.logout}\n        OnFailure = {this.handleLogoutFailure}\n        >\n        </GoogleLogout>:<GoogleLogin\n        clientId = {CLIENT_ID}\n        buttonText = 'Google Login'\n        onSuccess={this.login}\n        OnFailure = {this.handleLoginFailure}       \n        responseType = 'code,token'\n        />\n      }\n      <button className=\"btn btn-small\" id=\"logout\" onClick={this.onLogout}>Logout</button>\n      </div>\n      {this.state.accessToken ? <h5> You access token: <br/><br/> {this.state.accessToken}</h5>:null}\n\n\n</form>\n)}\n   </div>\n\n   </div>  \n\n   );\n }\n}\nexport default withRouter(Login);\n\n"]},"metadata":{},"sourceType":"module"}