{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport Comment from './Comment';\nimport KeepAliveContext from '../contexts/KeepAliveContext';\nimport createEventEmitter from '../utils/createEventEmitter';\nimport createUniqueIdentification from '../utils/createUniqueIdentification';\nimport createStoreElement from '../utils/createStoreElement';\nexport var keepAliveProviderTypeName = '$$KeepAliveProvider';\nexport var START_MOUNTING_DOM = 'startMountingDOM';\nexport var LIFECYCLE;\n\n(function (LIFECYCLE) {\n  LIFECYCLE[LIFECYCLE[\"MOUNTED\"] = 0] = \"MOUNTED\";\n  LIFECYCLE[LIFECYCLE[\"UPDATING\"] = 1] = \"UPDATING\";\n  LIFECYCLE[LIFECYCLE[\"UNMOUNTED\"] = 2] = \"UNMOUNTED\";\n})(LIFECYCLE || (LIFECYCLE = {}));\n\nvar KeepAliveProvider =\n/** @class */\nfunction (_super) {\n  __extends(KeepAliveProvider, _super);\n\n  function KeepAliveProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this; // Sometimes data that changes with setState cannot be synchronized, so force refresh\n\n\n    _this.cache = Object.create(null);\n    _this.keys = [];\n    _this.eventEmitter = createEventEmitter();\n    _this.existed = true;\n    _this.needRerender = false;\n    _this.providerIdentification = createUniqueIdentification();\n\n    _this.isExisted = function () {\n      return _this.existed;\n    };\n\n    _this.setCache = function (identification, value) {\n      var _a = _this,\n          cache = _a.cache,\n          keys = _a.keys;\n      var currentCache = cache[identification];\n\n      if (!currentCache) {\n        keys.push(identification);\n      }\n\n      _this.cache[identification] = __assign({}, currentCache, value);\n\n      _this.forceUpdate();\n    };\n\n    _this.unactivate = function (identification) {\n      var cache = _this.cache;\n      _this.cache[identification] = __assign({}, cache[identification], {\n        activated: false,\n        lifecycle: LIFECYCLE.UNMOUNTED\n      });\n\n      _this.forceUpdate();\n    };\n\n    _this.startMountingDOM = function (identification) {\n      _this.eventEmitter.emit([identification, START_MOUNTING_DOM]);\n    };\n\n    return _this;\n  }\n\n  KeepAliveProvider.prototype.componentDidMount = function () {\n    this.storeElement = createStoreElement();\n    this.forceUpdate();\n  };\n\n  KeepAliveProvider.prototype.componentDidUpdate = function () {\n    if (this.needRerender) {\n      this.needRerender = false;\n      this.forceUpdate();\n    }\n  };\n\n  KeepAliveProvider.prototype.componentWillUnmount = function () {\n    this.existed = false;\n    document.body.removeChild(this.storeElement);\n  };\n\n  KeepAliveProvider.prototype.render = function () {\n    var _this = this;\n\n    var _a = this,\n        cache = _a.cache,\n        keys = _a.keys,\n        providerIdentification = _a.providerIdentification,\n        isExisted = _a.isExisted,\n        setCache = _a.setCache,\n        existed = _a.existed,\n        unactivate = _a.unactivate,\n        storeElement = _a.storeElement,\n        eventEmitter = _a.eventEmitter;\n\n    var _b = this.props,\n        innerChildren = _b.children,\n        include = _b.include,\n        exclude = _b.exclude;\n\n    if (!storeElement) {\n      return null;\n    }\n\n    return React.createElement(KeepAliveContext.Provider, {\n      value: {\n        cache: cache,\n        keys: keys,\n        existed: existed,\n        providerIdentification: providerIdentification,\n        isExisted: isExisted,\n        setCache: setCache,\n        unactivate: unactivate,\n        storeElement: storeElement,\n        eventEmitter: eventEmitter,\n        include: include,\n        exclude: exclude\n      }\n    }, React.createElement(React.Fragment, null, innerChildren, keys.map(function (identification) {\n      var currentCache = cache[identification];\n      var keepAlive = currentCache.keepAlive,\n          children = currentCache.children,\n          lifecycle = currentCache.lifecycle;\n      var cacheChildren = children;\n\n      if (lifecycle === LIFECYCLE.MOUNTED && !keepAlive) {\n        // If the cache was last enabled, then the components of this keepAlive package are used,\n        // and the cache is not enabled, the UI needs to be reset.\n        cacheChildren = null;\n        _this.needRerender = true;\n        currentCache.lifecycle = LIFECYCLE.UPDATING;\n      } // current true, previous true | undefined, keepAlive false, not cache\n      // current true, previous true | undefined, keepAlive true, cache\n      // current true, previous false, keepAlive true, cache\n      // current true, previous false, keepAlive false, not cache\n\n\n      return ReactDOM.createPortal(cacheChildren ? React.createElement(React.Fragment, null, React.createElement(Comment, null, identification), cacheChildren, React.createElement(Comment, {\n        onLoaded: function () {\n          return _this.startMountingDOM(identification);\n        }\n      }, identification)) : null, storeElement);\n    })));\n  };\n\n  KeepAliveProvider.displayName = keepAliveProviderTypeName;\n  return KeepAliveProvider;\n}(React.PureComponent);\n\nexport default KeepAliveProvider;","map":{"version":3,"sources":["/Users/miabb/node_modules/react-component-keepalive/es/components/Provider.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","React","ReactDOM","Comment","KeepAliveContext","createEventEmitter","createUniqueIdentification","createStoreElement","keepAliveProviderTypeName","START_MOUNTING_DOM","LIFECYCLE","KeepAliveProvider","_super","_this","cache","keys","eventEmitter","existed","needRerender","providerIdentification","isExisted","setCache","identification","value","_a","currentCache","push","forceUpdate","unactivate","activated","lifecycle","UNMOUNTED","startMountingDOM","emit","componentDidMount","storeElement","componentDidUpdate","componentWillUnmount","document","body","removeChild","render","_b","props","innerChildren","children","include","exclude","createElement","Provider","Fragment","map","keepAlive","cacheChildren","MOUNTED","UPDATING","createPortal","onLoaded","displayName","PureComponent"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport Comment from './Comment';\r\nimport KeepAliveContext from '../contexts/KeepAliveContext';\r\nimport createEventEmitter from '../utils/createEventEmitter';\r\nimport createUniqueIdentification from '../utils/createUniqueIdentification';\r\nimport createStoreElement from '../utils/createStoreElement';\r\nexport var keepAliveProviderTypeName = '$$KeepAliveProvider';\r\nexport var START_MOUNTING_DOM = 'startMountingDOM';\r\nexport var LIFECYCLE;\r\n(function (LIFECYCLE) {\r\n    LIFECYCLE[LIFECYCLE[\"MOUNTED\"] = 0] = \"MOUNTED\";\r\n    LIFECYCLE[LIFECYCLE[\"UPDATING\"] = 1] = \"UPDATING\";\r\n    LIFECYCLE[LIFECYCLE[\"UNMOUNTED\"] = 2] = \"UNMOUNTED\";\r\n})(LIFECYCLE || (LIFECYCLE = {}));\r\nvar KeepAliveProvider = /** @class */ (function (_super) {\r\n    __extends(KeepAliveProvider, _super);\r\n    function KeepAliveProvider() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        // Sometimes data that changes with setState cannot be synchronized, so force refresh\r\n        _this.cache = Object.create(null);\r\n        _this.keys = [];\r\n        _this.eventEmitter = createEventEmitter();\r\n        _this.existed = true;\r\n        _this.needRerender = false;\r\n        _this.providerIdentification = createUniqueIdentification();\r\n        _this.isExisted = function () {\r\n            return _this.existed;\r\n        };\r\n        _this.setCache = function (identification, value) {\r\n            var _a = _this, cache = _a.cache, keys = _a.keys;\r\n            var currentCache = cache[identification];\r\n            if (!currentCache) {\r\n                keys.push(identification);\r\n            }\r\n            _this.cache[identification] = __assign({}, currentCache, value);\r\n            _this.forceUpdate();\r\n        };\r\n        _this.unactivate = function (identification) {\r\n            var cache = _this.cache;\r\n            _this.cache[identification] = __assign({}, cache[identification], { activated: false, lifecycle: LIFECYCLE.UNMOUNTED });\r\n            _this.forceUpdate();\r\n        };\r\n        _this.startMountingDOM = function (identification) {\r\n            _this.eventEmitter.emit([identification, START_MOUNTING_DOM]);\r\n        };\r\n        return _this;\r\n    }\r\n    KeepAliveProvider.prototype.componentDidMount = function () {\r\n        this.storeElement = createStoreElement();\r\n        this.forceUpdate();\r\n    };\r\n    KeepAliveProvider.prototype.componentDidUpdate = function () {\r\n        if (this.needRerender) {\r\n            this.needRerender = false;\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    KeepAliveProvider.prototype.componentWillUnmount = function () {\r\n        this.existed = false;\r\n        document.body.removeChild(this.storeElement);\r\n    };\r\n    KeepAliveProvider.prototype.render = function () {\r\n        var _this = this;\r\n        var _a = this, cache = _a.cache, keys = _a.keys, providerIdentification = _a.providerIdentification, isExisted = _a.isExisted, setCache = _a.setCache, existed = _a.existed, unactivate = _a.unactivate, storeElement = _a.storeElement, eventEmitter = _a.eventEmitter;\r\n        var _b = this.props, innerChildren = _b.children, include = _b.include, exclude = _b.exclude;\r\n        if (!storeElement) {\r\n            return null;\r\n        }\r\n        return (React.createElement(KeepAliveContext.Provider, { value: {\r\n                cache: cache,\r\n                keys: keys,\r\n                existed: existed,\r\n                providerIdentification: providerIdentification,\r\n                isExisted: isExisted,\r\n                setCache: setCache,\r\n                unactivate: unactivate,\r\n                storeElement: storeElement,\r\n                eventEmitter: eventEmitter,\r\n                include: include,\r\n                exclude: exclude,\r\n            } },\r\n            React.createElement(React.Fragment, null,\r\n                innerChildren,\r\n                keys.map(function (identification) {\r\n                    var currentCache = cache[identification];\r\n                    var keepAlive = currentCache.keepAlive, children = currentCache.children, lifecycle = currentCache.lifecycle;\r\n                    var cacheChildren = children;\r\n                    if (lifecycle === LIFECYCLE.MOUNTED && !keepAlive) {\r\n                        // If the cache was last enabled, then the components of this keepAlive package are used,\r\n                        // and the cache is not enabled, the UI needs to be reset.\r\n                        cacheChildren = null;\r\n                        _this.needRerender = true;\r\n                        currentCache.lifecycle = LIFECYCLE.UPDATING;\r\n                    }\r\n                    // current true, previous true | undefined, keepAlive false, not cache\r\n                    // current true, previous true | undefined, keepAlive true, cache\r\n                    // current true, previous false, keepAlive true, cache\r\n                    // current true, previous false, keepAlive false, not cache\r\n                    return ReactDOM.createPortal((cacheChildren\r\n                        ? (React.createElement(React.Fragment, null,\r\n                            React.createElement(Comment, null, identification),\r\n                            cacheChildren,\r\n                            React.createElement(Comment, { onLoaded: function () { return _this.startMountingDOM(identification); } }, identification)))\r\n                        : null), storeElement);\r\n                }))));\r\n    };\r\n    KeepAliveProvider.displayName = keepAliveProviderTypeName;\r\n    return KeepAliveProvider;\r\n}(React.PureComponent));\r\nexport default KeepAliveProvider;\r\n"]},"metadata":{},"sourceType":"module"}