{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as React from 'react';\nimport AsyncComponent from './AsyncComponent';\nimport { START_MOUNTING_DOM, LIFECYCLE } from './Provider';\nimport keepAlive, { COMMAND } from '../utils/keepAliveDecorator';\nimport changePositionByComment from '../utils/changePositionByComment';\n\nvar KeepAlive =\n/** @class */\nfunction (_super) {\n  __extends(KeepAlive, _super);\n\n  function KeepAlive() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.bindUnmount = null;\n    _this.bindUnactivate = null;\n    _this.unmounted = false;\n    _this.mounted = false;\n    _this.ref = null;\n    _this.refNextSibling = null;\n    _this.childNodes = [];\n\n    _this.correctionPosition = function () {\n      if (_this.ref && _this.ref.parentNode && _this.ref.nextSibling) {\n        var childNodes = _this.ref.childNodes;\n        _this.refNextSibling = _this.ref.nextSibling;\n        _this.childNodes = [];\n\n        while (childNodes.length) {\n          var child = childNodes[0];\n\n          _this.childNodes.push(child);\n\n          _this.ref.parentNode.insertBefore(child, _this.ref.nextSibling);\n        }\n\n        _this.ref.parentNode.removeChild(_this.ref);\n      }\n    };\n\n    _this.retreatPosition = function () {\n      if (_this.ref && _this.refNextSibling && _this.refNextSibling.parentNode) {\n        for (var _i = 0, _a = _this.childNodes; _i < _a.length; _i++) {\n          var child = _a[_i];\n\n          _this.ref.appendChild(child);\n        }\n\n        _this.refNextSibling.parentNode.insertBefore(_this.ref, _this.refNextSibling);\n      }\n    };\n\n    _this.setMounted = function (value) {\n      _this.mounted = value;\n    };\n\n    _this.getMounted = function () {\n      return _this.mounted;\n    };\n\n    return _this;\n  }\n\n  KeepAlive.prototype.componentDidMount = function () {\n    var _this = this;\n\n    var _container = this.props._container;\n    var notNeedActivate = _container.notNeedActivate,\n        identification = _container.identification,\n        eventEmitter = _container.eventEmitter,\n        keepAlive = _container.keepAlive;\n    notNeedActivate();\n\n    var cb = function () {\n      _this.mount();\n\n      _this.listen();\n\n      eventEmitter.off([identification, START_MOUNTING_DOM], cb);\n    };\n\n    eventEmitter.on([identification, START_MOUNTING_DOM], cb);\n\n    if (keepAlive) {\n      this.componentDidActivate();\n    }\n  };\n\n  KeepAlive.prototype.componentDidActivate = function () {// tslint-disable\n  };\n\n  KeepAlive.prototype.componentDidUpdate = function () {\n    var _container = this.props._container;\n    var notNeedActivate = _container.notNeedActivate,\n        isNeedActivate = _container.isNeedActivate;\n\n    if (isNeedActivate()) {\n      notNeedActivate();\n      this.mount();\n      this.listen();\n      this.unmounted = false;\n      this.componentDidActivate();\n    }\n  };\n\n  KeepAlive.prototype.componentWillUnactivate = function () {\n    this.unmount();\n    this.unlisten();\n  };\n\n  KeepAlive.prototype.componentWillUnmount = function () {\n    if (!this.unmounted) {\n      this.unmounted = true;\n      this.unmount();\n      this.unlisten();\n    }\n  };\n\n  KeepAlive.prototype.mount = function () {\n    var _a = this.props._container,\n        cache = _a.cache,\n        identification = _a.identification,\n        storeElement = _a.storeElement,\n        setLifecycle = _a.setLifecycle;\n    this.setMounted(true);\n    var renderElement = cache[identification].renderElement;\n    setLifecycle(LIFECYCLE.UPDATING);\n    changePositionByComment(identification, renderElement, storeElement);\n  };\n\n  KeepAlive.prototype.unmount = function () {\n    var _a = this.props._container,\n        identification = _a.identification,\n        storeElement = _a.storeElement,\n        cache = _a.cache,\n        setLifecycle = _a.setLifecycle;\n    var _b = cache[identification],\n        renderElement = _b.renderElement,\n        ifStillActivate = _b.ifStillActivate,\n        reactivate = _b.reactivate;\n    setLifecycle(LIFECYCLE.UNMOUNTED);\n    this.retreatPosition();\n    changePositionByComment(identification, storeElement, renderElement);\n\n    if (ifStillActivate) {\n      reactivate();\n    }\n  };\n\n  KeepAlive.prototype.listen = function () {\n    var _a = this.props._container,\n        identification = _a.identification,\n        eventEmitter = _a.eventEmitter;\n    eventEmitter.on([identification, COMMAND.CURRENT_UNMOUNT], this.bindUnmount = this.componentWillUnmount.bind(this));\n    eventEmitter.on([identification, COMMAND.CURRENT_UNACTIVATE], this.bindUnactivate = this.componentWillUnactivate.bind(this));\n  };\n\n  KeepAlive.prototype.unlisten = function () {\n    var _a = this.props._container,\n        identification = _a.identification,\n        eventEmitter = _a.eventEmitter;\n    eventEmitter.off([identification, COMMAND.CURRENT_UNMOUNT], this.bindUnmount);\n    eventEmitter.off([identification, COMMAND.CURRENT_UNACTIVATE], this.bindUnactivate);\n  };\n\n  KeepAlive.prototype.render = function () {\n    var _this = this; // The purpose of this div is to not report an error when moving the DOM,\n    // so you need to remove this div later.\n\n\n    return React.createElement(\"div\", {\n      ref: function (ref) {\n        return _this.ref = ref;\n      }\n    }, React.createElement(AsyncComponent, {\n      setMounted: this.setMounted,\n      getMounted: this.getMounted,\n      onUpdate: this.correctionPosition\n    }, this.props.children));\n  };\n\n  return KeepAlive;\n}(React.PureComponent);\n\nexport default keepAlive(KeepAlive);","map":{"version":3,"sources":["/Users/miabb/node_modules/react-component-keepalive/es/components/KeepAlive.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","React","AsyncComponent","START_MOUNTING_DOM","LIFECYCLE","keepAlive","COMMAND","changePositionByComment","KeepAlive","_super","_this","apply","arguments","bindUnmount","bindUnactivate","unmounted","mounted","ref","refNextSibling","childNodes","correctionPosition","parentNode","nextSibling","length","child","push","insertBefore","removeChild","retreatPosition","_i","_a","appendChild","setMounted","value","getMounted","componentDidMount","_container","props","notNeedActivate","identification","eventEmitter","cb","mount","listen","off","on","componentDidActivate","componentDidUpdate","isNeedActivate","componentWillUnactivate","unmount","unlisten","componentWillUnmount","cache","storeElement","setLifecycle","renderElement","UPDATING","_b","ifStillActivate","reactivate","UNMOUNTED","CURRENT_UNMOUNT","bind","CURRENT_UNACTIVATE","render","createElement","onUpdate","children","PureComponent"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as React from 'react';\r\nimport AsyncComponent from './AsyncComponent';\r\nimport { START_MOUNTING_DOM, LIFECYCLE } from './Provider';\r\nimport keepAlive, { COMMAND } from '../utils/keepAliveDecorator';\r\nimport changePositionByComment from '../utils/changePositionByComment';\r\nvar KeepAlive = /** @class */ (function (_super) {\r\n    __extends(KeepAlive, _super);\r\n    function KeepAlive() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.bindUnmount = null;\r\n        _this.bindUnactivate = null;\r\n        _this.unmounted = false;\r\n        _this.mounted = false;\r\n        _this.ref = null;\r\n        _this.refNextSibling = null;\r\n        _this.childNodes = [];\r\n        _this.correctionPosition = function () {\r\n            if (_this.ref && _this.ref.parentNode && _this.ref.nextSibling) {\r\n                var childNodes = _this.ref.childNodes;\r\n                _this.refNextSibling = _this.ref.nextSibling;\r\n                _this.childNodes = [];\r\n                while (childNodes.length) {\r\n                    var child = childNodes[0];\r\n                    _this.childNodes.push(child);\r\n                    _this.ref.parentNode.insertBefore(child, _this.ref.nextSibling);\r\n                }\r\n                _this.ref.parentNode.removeChild(_this.ref);\r\n            }\r\n        };\r\n        _this.retreatPosition = function () {\r\n            if (_this.ref && _this.refNextSibling && _this.refNextSibling.parentNode) {\r\n                for (var _i = 0, _a = _this.childNodes; _i < _a.length; _i++) {\r\n                    var child = _a[_i];\r\n                    _this.ref.appendChild(child);\r\n                }\r\n                _this.refNextSibling.parentNode.insertBefore(_this.ref, _this.refNextSibling);\r\n            }\r\n        };\r\n        _this.setMounted = function (value) {\r\n            _this.mounted = value;\r\n        };\r\n        _this.getMounted = function () {\r\n            return _this.mounted;\r\n        };\r\n        return _this;\r\n    }\r\n    KeepAlive.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        var _container = this.props._container;\r\n        var notNeedActivate = _container.notNeedActivate, identification = _container.identification, eventEmitter = _container.eventEmitter, keepAlive = _container.keepAlive;\r\n        notNeedActivate();\r\n        var cb = function () {\r\n            _this.mount();\r\n            _this.listen();\r\n            eventEmitter.off([identification, START_MOUNTING_DOM], cb);\r\n        };\r\n        eventEmitter.on([identification, START_MOUNTING_DOM], cb);\r\n        if (keepAlive) {\r\n            this.componentDidActivate();\r\n        }\r\n    };\r\n    KeepAlive.prototype.componentDidActivate = function () {\r\n        // tslint-disable\r\n    };\r\n    KeepAlive.prototype.componentDidUpdate = function () {\r\n        var _container = this.props._container;\r\n        var notNeedActivate = _container.notNeedActivate, isNeedActivate = _container.isNeedActivate;\r\n        if (isNeedActivate()) {\r\n            notNeedActivate();\r\n            this.mount();\r\n            this.listen();\r\n            this.unmounted = false;\r\n            this.componentDidActivate();\r\n        }\r\n    };\r\n    KeepAlive.prototype.componentWillUnactivate = function () {\r\n        this.unmount();\r\n        this.unlisten();\r\n    };\r\n    KeepAlive.prototype.componentWillUnmount = function () {\r\n        if (!this.unmounted) {\r\n            this.unmounted = true;\r\n            this.unmount();\r\n            this.unlisten();\r\n        }\r\n    };\r\n    KeepAlive.prototype.mount = function () {\r\n        var _a = this.props._container, cache = _a.cache, identification = _a.identification, storeElement = _a.storeElement, setLifecycle = _a.setLifecycle;\r\n        this.setMounted(true);\r\n        var renderElement = cache[identification].renderElement;\r\n        setLifecycle(LIFECYCLE.UPDATING);\r\n        changePositionByComment(identification, renderElement, storeElement);\r\n    };\r\n    KeepAlive.prototype.unmount = function () {\r\n        var _a = this.props._container, identification = _a.identification, storeElement = _a.storeElement, cache = _a.cache, setLifecycle = _a.setLifecycle;\r\n        var _b = cache[identification], renderElement = _b.renderElement, ifStillActivate = _b.ifStillActivate, reactivate = _b.reactivate;\r\n        setLifecycle(LIFECYCLE.UNMOUNTED);\r\n        this.retreatPosition();\r\n        changePositionByComment(identification, storeElement, renderElement);\r\n        if (ifStillActivate) {\r\n            reactivate();\r\n        }\r\n    };\r\n    KeepAlive.prototype.listen = function () {\r\n        var _a = this.props._container, identification = _a.identification, eventEmitter = _a.eventEmitter;\r\n        eventEmitter.on([identification, COMMAND.CURRENT_UNMOUNT], this.bindUnmount = this.componentWillUnmount.bind(this));\r\n        eventEmitter.on([identification, COMMAND.CURRENT_UNACTIVATE], this.bindUnactivate = this.componentWillUnactivate.bind(this));\r\n    };\r\n    KeepAlive.prototype.unlisten = function () {\r\n        var _a = this.props._container, identification = _a.identification, eventEmitter = _a.eventEmitter;\r\n        eventEmitter.off([identification, COMMAND.CURRENT_UNMOUNT], this.bindUnmount);\r\n        eventEmitter.off([identification, COMMAND.CURRENT_UNACTIVATE], this.bindUnactivate);\r\n    };\r\n    KeepAlive.prototype.render = function () {\r\n        var _this = this;\r\n        // The purpose of this div is to not report an error when moving the DOM,\r\n        // so you need to remove this div later.\r\n        return (React.createElement(\"div\", { ref: function (ref) { return _this.ref = ref; } },\r\n            React.createElement(AsyncComponent, { setMounted: this.setMounted, getMounted: this.getMounted, onUpdate: this.correctionPosition }, this.props.children)));\r\n    };\r\n    return KeepAlive;\r\n}(React.PureComponent));\r\nexport default keepAlive(KeepAlive);\r\n"]},"metadata":{},"sourceType":"module"}